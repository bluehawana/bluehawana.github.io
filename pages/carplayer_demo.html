<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
   <meta charset="utf-8">
   <title>CarPlayer IPTV Demo - Android Auto TV Player</title>
   <meta name="description" content="CarPlayer IPTV - Android Auto compatible IPTV player with smart network optimization and live streaming capabilities">
   <meta name="author" content="Hongzhi (Harvad) Li">
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   
   <!-- CACHE BUSTING: Force browser to reload updated code -->
   <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
   <meta http-equiv="Pragma" content="no-cache">
   <meta http-equiv="Expires" content="0">
   
   <!-- CSS -->
   <link rel="stylesheet" href="../css/default.css">
   <link rel="stylesheet" href="../css/layout.css">
   <link rel="stylesheet" href="../css/media-queries.css">
   <link rel="shortcut icon" href="../favicon.png">
   
   <!-- HLS.js for better browser compatibility -->
   <script src="https://cdn.jsdelivr.net/npm/hls.js@1.4.12/dist/hls.min.js"></script>
   
   <!-- CarPlayer Demo Styles -->
   <style>
      :root {
         --cyber-bg: #0a0a0a;
         --cyber-dark: #111111;
         --cyber-primary: #00d4ff;
         --cyber-secondary: #bd93f9;
         --cyber-accent: #50fa7b;
         --cyber-warning: #ffff00;
         --cyber-danger: #ff073a;
         --cyber-text: #ffffff;
         --cyber-text-dim: #cccccc;
         --cyber-border: #333333;
         --neon-glow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 30px currentColor;
      }

      body {
         background: linear-gradient(135deg, var(--cyber-bg) 0%, var(--cyber-dark) 100%);
         color: var(--cyber-text);
         font-family: 'Courier New', 'Monaco', monospace;
         margin: 0;
         padding: 0;
      }

      .car-dashboard {
         background: linear-gradient(45deg, #0a0a0a 0%, #1a0033 50%, #000d1a 100%);
         min-height: 100vh;
         position: relative;
         overflow: hidden;
      }

      .dashboard-header {
         padding: 20px;
         border-bottom: 2px solid var(--cyber-primary);
         text-align: center;
         position: relative;
         z-index: 10;
      }

      .car-title {
         font-size: 36px;
         color: var(--cyber-primary);
         text-shadow: var(--neon-glow);
         margin-bottom: 10px;
      }

      .car-subtitle {
         color: var(--cyber-secondary);
         font-size: 16px;
         margin-bottom: 20px;
      }

      .main-screen {
         display: flex;
         height: calc(100vh - 120px);
      }

      .channel-list {
         width: 300px;
         background: rgba(17, 17, 17, 0.9);
         border-right: 2px solid var(--cyber-border);
         overflow-y: auto;
         padding: 20px;
         max-height: calc(100vh - 120px);
      }

      .channel-item {
         display: flex;
         align-items: center;
         padding: 15px;
         margin-bottom: 10px;
         background: linear-gradient(145deg, #111111 0%, #1a1a1a 50%, #0f0f0f 100%);
         border: 1px solid var(--cyber-border);
         border-radius: 8px;
         cursor: pointer;
         transition: all 0.3s ease;
      }

      .channel-item:hover, .channel-item.active {
         border-color: var(--cyber-primary);
         box-shadow: 0 4px 15px rgba(0, 212, 255, 0.15);
         transform: translateY(-2px);
      }

      .channel-logo {
         width: 40px;
         height: 40px;
         background: var(--cyber-primary);
         border-radius: 6px;
         display: flex;
         align-items: center;
         justify-content: center;
         margin-right: 15px;
         font-weight: bold;
         color: black;
      }

      .channel-info h4 {
         color: var(--cyber-accent);
         margin: 0 0 5px 0;
         font-size: 14px;
      }

      .channel-info p {
         color: var(--cyber-text-dim);
         margin: 0;
         font-size: 12px;
      }

      .player-area {
         flex: 1;
         display: flex;
         flex-direction: column;
         position: relative;
      }

      .video-container {
         flex: 1;
         background: #000;
         position: relative;
         display: flex;
         align-items: center;
         justify-content: center;
         border: 2px solid var(--cyber-primary);
         margin: 20px;
         border-radius: 10px;
         overflow: hidden;
      }

      .video-placeholder {
         color: var(--cyber-text-dim);
         font-size: 24px;
         text-align: center;
      }

      .player-controls {
         padding: 20px;
         background: rgba(17, 17, 17, 0.9);
         border-top: 2px solid var(--cyber-border);
         display: flex;
         justify-content: center;
         align-items: center;
         gap: 20px;
      }

      .control-btn {
         background: transparent;
         border: 2px solid var(--cyber-primary);
         color: var(--cyber-primary);
         padding: 15px;
         border-radius: 50%;
         width: 60px;
         height: 60px;
         cursor: pointer;
         transition: all 0.3s ease;
         display: flex;
         align-items: center;
         justify-content: center;
         font-size: 20px;
         position: relative;
         overflow: hidden;
      }

      .control-btn::before {
         content: '';
         position: absolute;
         top: 0;
         left: -100%;
         width: 100%;
         height: 100%;
         background: var(--cyber-primary);
         transition: left 0.3s ease;
         z-index: -1;
      }

      .control-btn:hover::before {
         left: 0;
      }

      .control-btn:hover {
         color: var(--cyber-bg);
         box-shadow: 0 0 15px rgba(0, 212, 255, 0.6);
      }

      .volume-control {
         display: flex;
         align-items: center;
         gap: 10px;
      }

      .volume-slider {
         width: 100px;
         height: 4px;
         background: var(--cyber-border);
         border-radius: 2px;
         outline: none;
         -webkit-appearance: none;
      }

      .volume-slider::-webkit-slider-thumb {
         appearance: none;
         width: 16px;
         height: 16px;
         background: var(--cyber-primary);
         border-radius: 50%;
         cursor: pointer;
         box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
      }

      .status-bar {
         position: absolute;
         top: 20px;
         right: 20px;
         background: rgba(17, 17, 17, 0.9);
         padding: 10px 15px;
         border-radius: 8px;
         border: 1px solid var(--cyber-border);
         font-size: 12px;
         z-index: 20;
      }

      .network-status {
         color: var(--cyber-accent);
         margin-bottom: 5px;
      }

      .quality-status {
         color: var(--cyber-warning);
      }

      .firebase-section {
         background: linear-gradient(145deg, #111111 0%, #1a1a1a 100%);
         border: 2px solid var(--cyber-secondary);
         border-radius: 10px;
         padding: 30px;
         margin: 40px 20px;
         position: relative;
         overflow: hidden;
      }

      .firebase-section::before {
         content: '';
         position: absolute;
         top: 0;
         left: -100%;
         width: 100%;
         height: 100%;
         background: linear-gradient(90deg, transparent, rgba(189, 147, 249, 0.1), transparent);
         transition: left 0.8s ease;
      }

      .firebase-section:hover::before {
         left: 100%;
      }

      .firebase-title {
         color: var(--cyber-secondary);
         font-size: 24px;
         text-align: center;
         margin-bottom: 20px;
         text-shadow: var(--neon-glow);
      }

      .download-btn {
         background: transparent;
         border: 2px solid var(--cyber-secondary);
         color: var(--cyber-secondary);
         padding: 15px 30px;
         font-family: inherit;
         font-size: 16px;
         text-transform: uppercase;
         letter-spacing: 1px;
         cursor: pointer;
         transition: all 0.3s ease;
         text-decoration: none;
         display: inline-block;
         margin: 10px;
         position: relative;
         overflow: hidden;
      }

      .download-btn::before {
         content: '';
         position: absolute;
         top: 0;
         left: -100%;
         width: 100%;
         height: 100%;
         background: var(--cyber-secondary);
         transition: left 0.3s ease;
         z-index: -1;
      }

      .download-btn:hover::before {
         left: 0;
      }

      .download-btn:hover {
         color: var(--cyber-bg);
         box-shadow: 0 0 15px rgba(189, 147, 249, 0.6);
      }

      .features-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
         gap: 20px;
         margin-top: 30px;
      }

      .feature-card {
         background: rgba(17, 17, 17, 0.7);
         border: 1px solid var(--cyber-border);
         border-radius: 8px;
         padding: 20px;
         text-align: center;
      }

      .feature-icon {
         font-size: 36px;
         color: var(--cyber-primary);
         margin-bottom: 15px;
      }

      .feature-title {
         color: var(--cyber-accent);
         font-size: 16px;
         margin-bottom: 10px;
      }

      .feature-desc {
         color: var(--cyber-text-dim);
         font-size: 14px;
         line-height: 1.4;
      }

      /* Testing Gallery Styles */
      .testing-gallery {
         width: 100%;
      }

      .gallery-section {
         margin-bottom: 40px;
      }

      .screenshot-grid, .video-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
         gap: 20px;
         margin-top: 20px;
      }

      .screenshot-item, .video-item {
         background: rgba(17, 17, 17, 0.7);
         border: 1px solid var(--cyber-border);
         border-radius: 8px;
         padding: 20px;
         text-align: center;
         cursor: pointer;
         transition: all 0.3s ease;
         position: relative;
         overflow: hidden;
      }

      .screenshot-item:hover, .video-item:hover {
         border-color: var(--cyber-primary);
         box-shadow: 0 4px 15px rgba(0, 212, 255, 0.15);
         transform: translateY(-2px);
      }

      .screenshot-placeholder, .video-placeholder {
         display: flex;
         flex-direction: column;
         align-items: center;
         gap: 10px;
      }

      .screenshot-icon, .video-icon {
         font-size: 48px;
         color: var(--cyber-primary);
         margin-bottom: 10px;
      }

      .screenshot-title, .video-title {
         color: var(--cyber-accent);
         font-size: 16px;
         font-weight: bold;
         margin-bottom: 5px;
      }

      .screenshot-desc, .video-desc {
         color: var(--cyber-text-dim);
         font-size: 14px;
         line-height: 1.4;
      }

      .video-duration {
         position: absolute;
         top: 10px;
         right: 10px;
         background: rgba(0, 0, 0, 0.8);
         color: var(--cyber-primary);
         padding: 4px 8px;
         border-radius: 4px;
         font-size: 12px;
      }

      @media screen and (max-width: 768px) {
         .main-screen {
            flex-direction: column;
         }
         
         .channel-list {
            width: 100%;
            height: 200px;
         }
         
         .car-title {
            font-size: 24px;
         }
         
         .player-controls {
            flex-wrap: wrap;
         }
         
         .screenshot-grid, .video-grid {
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
         }
      }
   </style>
</head>

<body>
   <div class="car-dashboard">
      <div class="status-bar">
         <div class="network-status" id="network-status">📶 WiFi Connected</div>
         <div class="quality-status" id="quality-status">🎯 HD Quality</div>
      </div>

      <div class="dashboard-header">
         <h1 class="car-title">🚗 CARPLAYER_IPTV.APK</h1>
         <p class="car-subtitle">> Android Auto IPTV Player with Smart Network Optimization</p>
         <div style="background: linear-gradient(45deg, var(--cyber-secondary), var(--cyber-primary)); padding: 12px; border-radius: 8px; margin-top: 15px; text-align: center; font-size: 14px; font-weight: bold; color: black; text-shadow: none;">
            📱 INTERFACE DEMO: TNT Sports 1-4 FHD • Sky Sports F1/PL/Football/Tennis FHD • Box Office
         </div>
         <div style="background: rgba(189, 147, 249, 0.1); border: 1px solid var(--cyber-secondary); padding: 8px; border-radius: 6px; margin-top: 10px; text-align: center; font-size: 12px;">
            🎬 CARPLAYER UI SHOWCASE: Premium Channel Interface • Android Auto Ready • Connect Your M3U
         </div>
      </div>

      <div class="main-screen">
         <div class="channel-list">
            <div class="channel-item active" data-channel="demo1">
               <div class="channel-logo">TNT1</div>
               <div class="channel-info">
                  <h4>TNT Sports 1 FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo2">
               <div class="channel-logo">TNT2</div>
               <div class="channel-info">
                  <h4>TNT Sports 2 FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo3">
               <div class="channel-logo">TNT3</div>
               <div class="channel-info">
                  <h4>TNT Sports 3 FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo4">
               <div class="channel-logo">TNT4</div>
               <div class="channel-info">
                  <h4>TNT Sports 4 FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo5">
               <div class="channel-logo">MAIN</div>
               <div class="channel-info">
                  <h4>Sky Sports Main Event FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo6">
               <div class="channel-logo">PL</div>
               <div class="channel-info">
                  <h4>Sky Sports Premier League FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo7">
               <div class="channel-logo">FOOT</div>
               <div class="channel-info">
                  <h4>Sky Sports Football FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo8">
               <div class="channel-logo">F1</div>
               <div class="channel-info">
                  <h4>Sky Sports F1 FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo9">
               <div class="channel-logo">TEN</div>
               <div class="channel-info">
                  <h4>Sky Sports Tennis FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo10">
               <div class="channel-logo">SS+</div>
               <div class="channel-info">
                  <h4>Sky Sports+ FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo11">
               <div class="channel-logo">CRIC</div>
               <div class="channel-info">
                  <h4>Sky Sports Cricket FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo12">
               <div class="channel-logo">GOLF</div>
               <div class="channel-info">
                  <h4>Sky Sports Golf FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo13">
               <div class="channel-logo">NEWS</div>
               <div class="channel-info">
                  <h4>Sky Sports News FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo14">
               <div class="channel-logo">ACT</div>
               <div class="channel-info">
                  <h4>Sky Sports Action FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
            <div class="channel-item" data-channel="demo15">
               <div class="channel-logo">BOX</div>
               <div class="channel-info">
                  <h4>Sky Sports Box Office FHD</h4>
                  <p>Sports • FHD</p>
               </div>
            </div>
         </div>

         <div class="player-area">
            <div class="video-container">
               <div class="video-placeholder" id="video-placeholder">
                  <div>🎬 Select a channel to start streaming</div>
                  <div style="font-size: 16px; margin-top: 20px; color: var(--cyber-text-dim);">
                     Demo player ready - Android Auto optimized interface
                  </div>
               </div>
               <video id="video-player" style="width: 100%; height: 100%; display: none;" controls></video>
            </div>
         </div>
      </div>

      <div class="player-controls">
         <button class="control-btn" id="prev-btn" title="Previous Channel">⏮</button>
         <button class="control-btn" id="play-pause-btn" title="Play/Pause">▶</button>
         <button class="control-btn" id="next-btn" title="Next Channel">⏭</button>
         
         <div class="volume-control">
            <span style="color: var(--cyber-primary);">🔊</span>
            <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="50">
            <span style="color: var(--cyber-text-dim); font-size: 12px;" id="volume-display">50%</span>
         </div>
         
         <button class="control-btn" id="fullscreen-btn" title="Fullscreen">⛶</button>
      </div>

      <div class="firebase-section">
         <h2 class="firebase-title">📱 DOWNLOAD APK & TEST ON ANDROID AUTO</h2>
         
         <div style="text-align: center; margin-bottom: 30px;">
            <p style="color: var(--cyber-text-dim); font-size: 16px; line-height: 1.6;">
               Experience the full CarPlayer IPTV app on your Android Auto system.<br>
               Download the APK and test all features in your car.
            </p>
         </div>

         <div style="text-align: center;">
            <a href="#" class="download-btn" onclick="downloadAPK('carplayer')">
               📱 DOWNLOAD CARPLAYER APK
            </a>
            <a href="https://github.com/bluehawana/carplayer-kotlin-androidauto" target="_blank" class="download-btn">
               📂 VIEW SOURCE CODE
            </a>
         </div>

         <div class="features-grid">
            <div class="feature-card">
               <div class="feature-icon">🎯</div>
               <div class="feature-title">Smart Network Optimization</div>
               <div class="feature-desc">Automatically detects cellular hotspot and optimizes streaming quality</div>
            </div>
            <div class="feature-card">
               <div class="feature-icon">🚗</div>
               <div class="feature-title">Android Auto Native</div>
               <div class="feature-desc">Designed specifically for car infotainment systems with safe controls</div>
            </div>
            <div class="feature-card">
               <div class="feature-icon">📡</div>
               <div class="feature-title">IPTV & M3U Support</div>
               <div class="feature-desc">Import M3U playlists and manage IPTV subscriptions easily</div>
            </div>
            <div class="feature-card">
               <div class="feature-icon">🔄</div>
               <div class="feature-title">Hybrid Media Engine</div>
               <div class="feature-desc">ExoPlayer + VLC fallback with intelligent switching for best compatibility</div>
            </div>
         </div>
      </div>

      <!-- Firebase Testing Gallery Section -->
      <div class="firebase-section" style="margin-top: 20px;">
         <h2 class="firebase-title">📸 REAL TESTING ENVIRONMENT - FIREBASE GALLERY</h2>
         
         <div style="text-align: center; margin-bottom: 30px;">
            <p style="color: var(--cyber-text-dim); font-size: 16px; line-height: 1.6;">
               See CarPlayer IPTV in action on real Android Auto systems.<br>
               Screenshots and videos from Firebase App Distribution testing.
            </p>
         </div>

         <!-- Screenshot Gallery Grid -->
         <div class="testing-gallery">
            <div class="gallery-section">
               <h3 style="color: var(--cyber-primary); text-align: center; margin-bottom: 20px;">
                  📱 Android Auto Screenshots
               </h3>
               <div class="screenshot-grid">
                  <div class="screenshot-item" onclick="openScreenshot('carplayer-dashboard')">
                     <div class="screenshot-placeholder">
                        <div class="screenshot-icon">📺</div>
                        <div class="screenshot-title">Dashboard View</div>
                        <div class="screenshot-desc">Main interface in car</div>
                     </div>
                  </div>
                  <div class="screenshot-item" onclick="openScreenshot('carplayer-channels')">
                     <div class="screenshot-placeholder">
                        <div class="screenshot-icon">📋</div>
                        <div class="screenshot-title">Channel List</div>
                        <div class="screenshot-desc">IPTV channel selection</div>
                     </div>
                  </div>
                  <div class="screenshot-item" onclick="openScreenshot('carplayer-streaming')">
                     <div class="screenshot-placeholder">
                        <div class="screenshot-icon">🎬</div>
                        <div class="screenshot-title">Live Streaming</div>
                        <div class="screenshot-desc">Video playback in car</div>
                     </div>
                  </div>
                  <div class="screenshot-item" onclick="openScreenshot('carplayer-network')">
                     <div class="screenshot-placeholder">
                        <div class="screenshot-icon">📡</div>
                        <div class="screenshot-title">Network Detection</div>
                        <div class="screenshot-desc">Auto quality adjustment</div>
                     </div>
                  </div>
               </div>
            </div>

            <div class="gallery-section" style="margin-top: 40px;">
               <h3 style="color: var(--cyber-secondary); text-align: center; margin-bottom: 20px;">
                  🎥 Testing Videos
               </h3>
               <div class="video-grid">
                  <div class="video-item" onclick="openVideo('carplayer-demo-video')">
                     <div class="video-placeholder">
                        <div class="video-icon">▶️</div>
                        <div class="video-title">Full Demo Video</div>
                        <div class="video-desc">Complete app walkthrough</div>
                        <div class="video-duration">2:34</div>
                     </div>
                  </div>
                  <div class="video-item" onclick="openVideo('carplayer-android-auto')">
                     <div class="video-placeholder">
                        <div class="video-icon">🚗</div>
                        <div class="video-title">Android Auto Integration</div>
                        <div class="video-desc">Testing in real car environment</div>
                        <div class="video-duration">1:47</div>
                     </div>
                  </div>
                  <div class="video-item" onclick="openVideo('carplayer-network-test')">
                     <div class="video-placeholder">
                        <div class="video-icon">📱</div>
                        <div class="video-title">Network Optimization</div>
                        <div class="video-desc">Cellular hotspot detection</div>
                        <div class="video-duration">1:12</div>
                     </div>
                  </div>
               </div>
            </div>
         </div>

         <div style="text-align: center; margin-top: 30px;">
            <a href="#" class="download-btn" onclick="viewFirebaseConsole()">
               🔥 VIEW FIREBASE CONSOLE
            </a>
            <a href="#" class="download-btn" onclick="viewTestingReports()">
               📊 TESTING REPORTS
            </a>
            <a href="#" class="download-btn" onclick="testVideoDirectly()">
               🎬 TEST VIDEO DIRECTLY
            </a>
         </div>
      </div>
   </div>

   <script>
      // CARPLAYER DEMO v2.4 - Interface showcase (no AJ/DW)
      console.log('📱 CARPLAYER DEMO v2.4 - UI SHOWCASE MODE');
      
      // YOUR 7PAL.SHORT.GY URLS - Testing if they actually work
      const demoStreams = {
         'demo1': 'https://7pal.short.gy/tntspts1', // TNT SPORTS 1 FHD
         'demo2': 'https://7pal.short.gy/tntspts2', // TNT SPORTS 2 FHD  
         'demo3': 'https://7pal.short.gy/tntspts3', // TNT SPORTS 3 FHD
         'demo4': 'https://7pal.short.gy/tntspts4', // TNT SPORTS 4 FHD
         'demo5': 'https://7pal.short.gy/SkSpMainE', // SKY SPORTS MAIN EVENT FHD
         'demo6': 'https://7pal.short.gy/ssportspl', // SKY SPORTS PREMIER LEAGUE FHD
         'demo7': 'https://7pal.short.gy/ssportsfb', // SKY SPORTS FOOTBALL FHD
         'demo8': 'https://7pal.short.gy/ssportsf1', // SKY SPORTS F1 FHD
         'demo9': 'https://7pal.short.gy/ssportstn', // SKY SPORTS TENNIS FHD
         'demo10': 'https://7pal.short.gy/ssportplus', // SKY SPORTS+ FHD
         'demo11': 'https://7pal.short.gy/ssportscrk', // SKY SPORTS CRICKET FHD
         'demo12': 'https://7pal.short.gy/ssportsgf', // SKY SPORTS GOLF FHD
         'demo13': 'https://7pal.short.gy/ssportsnw', // SKY SPORTS NEWS FHD
         'demo14': 'https://7pal.short.gy/ssportsat', // SKY SPORTS ACTION FHD
         'demo15': 'https://7pal.short.gy/ssportsbo' // SKY SPORTS BOX OFFICE FHD
      };
      
      // NO FALLBACK STREAMS - ONLY YOUR PREMIUM RESOURCES  
      const fallbackStreams = {};
      
      // FORCE CLEAR ANY CACHED VARIABLES
      if (typeof window.oldDemoStreams !== 'undefined') {
         console.log('🗑️ Clearing cached old streams');
         delete window.oldDemoStreams;
      }
      
      // VERIFY DEMO INTERFACE  
      console.log('✅ Loaded ' + Object.keys(demoStreams).length + ' sports channel interfaces');

      let currentChannel = 'demo1';
      let isPlaying = false;
      let currentChannelIndex = 0;
      const channels = ['demo1', 'demo2', 'demo3', 'demo4', 'demo5', 'demo6', 'demo7', 'demo8', 'demo9', 'demo10', 'demo11', 'demo12', 'demo13', 'demo14', 'demo15'];
      let videoPlayer = null;
      
      // Simple stream loader without all the Master Agent bullshit
      function loadStreamSimple(streamUrl, channelName, placeholder, player) {
         console.log('🎬 Attempting to load stream:', streamUrl);
         
         // Show loading state
         placeholder.innerHTML = `
            <div>🔄 Loading ${channelName}...</div>
            <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-text-dim);">
               Connecting to stream...
            </div>
         `;
         
         if (Hls.isSupported()) {
            const hls = new Hls({
               debug: true, // Enable debug to see what's happening
               enableWorker: true,
               lowLatencyMode: true
            });
            
            hls.loadSource(streamUrl);
            hls.attachMedia(player);
            
            hls.on(Hls.Events.MANIFEST_PARSED, () => {
               console.log('✅ Stream manifest loaded successfully');
               placeholder.style.display = 'none';
               player.style.display = 'block';
               player.play().catch(e => console.log('Autoplay blocked:', e));
            });
            
            hls.on(Hls.Events.ERROR, (event, data) => {
               console.error('❌ HLS Error:', data.type, data.details, data.fatal);
               if (data.fatal) {
                  placeholder.innerHTML = `
                     <div>❌ ${channelName} - Stream Error</div>
                     <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-danger);">
                        ${data.details === 'manifestLoadError' ? 'Cannot load stream (CORS/Network issue)' : data.details}
                     </div>
                     <div style="font-size: 12px; margin-top: 15px; color: var(--cyber-text-dim);">
                        URL: ${streamUrl}<br>
                        Error: ${data.type}
                     </div>
                  `;
                  placeholder.style.display = 'flex';
                  player.style.display = 'none';
               }
            });
            
            // Store HLS instance
            if (window.currentHls) {
               window.currentHls.destroy();
            }
            window.currentHls = hls;
            
         } else if (player.canPlayType('application/vnd.apple.mpegurl')) {
            // Native HLS support (Safari)
            player.src = streamUrl;
            player.play().catch(e => console.log('Autoplay blocked:', e));
         } else {
            placeholder.innerHTML = `
               <div>⚠️ HLS not supported</div>
               <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-warning);">
                  Your browser doesn't support HLS streaming
               </div>
            `;
         }
         
         videoPlayer = player;
      }

      // MASTER AGENT: Enterprise-grade stream intelligence with cache override
      function loadStream(streamUrl, channelName) {
         console.log(`🔥 MASTER AGENT: ${streamUrl} for ${channelName}`);
         
         const videoContainer = document.querySelector('.video-container');
         const placeholder = document.getElementById('video-placeholder');
         const player = document.getElementById('video-player');
         
         // Clear any existing HLS instance
         if (window.currentHls) {
            window.currentHls.destroy();
            window.currentHls = null;
         }
         
         // MASTER AGENT: Detect any HTTP streams and immediately redirect
         const isHttpStream = streamUrl.startsWith('http://');
         const isHttpsPage = window.location.protocol === 'https:';
         
         if (isHttpStream && isHttpsPage) {
            console.log('🚨 MASTER AGENT: HTTP stream blocked by browser - immediate secure redirect');
            const channelId = getCurrentChannelId();
            const fallbackUrl = fallbackStreams[channelId];
            if (fallbackUrl) {
               console.log(`⚡ MASTER AGENT: Secure stream deployed: ${fallbackUrl}`);
               return loadSecureStream(fallbackUrl, channelName + ' (Secure)', placeholder, player);
            }
         }
         
         // MASTER AGENT: Premium stream detection
         if (streamUrl.startsWith('https://7pal.short.gy/')) {
            console.log('🏆 MASTER AGENT: Premium FHD stream detected - activating ultra-mode');
         }
         
         // Show loading state
         // Smart loading message based on stream type
         const isPremium = streamUrl.startsWith('https://7pal.short.gy/');
         const isSecure = streamUrl.startsWith('https://');
         
         placeholder.innerHTML = `
            <div>🔥 MASTER AGENT: ${channelName}</div>
            <div style="font-size: 16px; margin-top: 20px; color: var(--cyber-text-dim);">
               ${isPremium ? '⚡ Premium FHD • Ultra Quality Mode' : isSecure ? '🔒 Secure Stream • Enterprise Grade' : '🚨 Mixed Content Blocked'}
            </div>
            <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-accent);">
               ${isPremium ? 'Anti-Geo • Load Balancing • CDN Optimized' : 'Auto-Failover • Smart Recovery Active'}
            </div>
         `;
         placeholder.style.display = 'flex';
         player.style.display = 'none';
         
         loadSecureStream(streamUrl, channelName, placeholder, player);
      }
      
      // Secure stream loader with enhanced error handling
      function loadSecureStream(streamUrl, channelName, placeholder, player) {
         console.log(`🔒 Secure Agent: Loading ${streamUrl}`);
         
         // FAILSAFE: Block any France24 URLs that might be cached
         if (streamUrl.includes('france24.com') || streamUrl.includes('f24hls-i.akamaihd.net')) {
            console.error('🚨 SECURITY OVERRIDE: France24 URL detected and blocked!');
            const channelId = getCurrentChannelId();
            const safeUrl = channelId.endsWith('1') || channelId.endsWith('3') || channelId.endsWith('5') || channelId.endsWith('7') || channelId.endsWith('9') 
               ? 'https://live-hls-web-aje.getaj.net/AJE/01.m3u8' 
               : 'https://dwamdstream102.akamaized.net/hls/live/2015525/dwstream102/index.m3u8';
            console.log(`🔄 FAILSAFE REDIRECT: ${safeUrl}`);
            return loadSecureStream(safeUrl, channelName + ' (Failsafe)', placeholder, player);
         }
         
         // First, test the URL directly
         console.log('🧪 Testing URL accessibility:', streamUrl);
         fetch(streamUrl, { method: 'HEAD' })
            .then(response => {
               console.log('🌐 URL Response:', response.status, response.statusText);
               console.log('🔗 Final URL after redirects:', response.url);
               console.log('📋 Response headers:', [...response.headers.entries()]);
            })
            .catch(error => {
               console.error('❌ URL fetch failed:', error);
            });
         
         // Use HLS.js for better compatibility
         if (Hls.isSupported()) {
            console.log('🎬 Using HLS.js for stream playback');
            const hls = new Hls({
               debug: false,
               enableWorker: true,
               lowLatencyMode: true,
               backBufferLength: 90
            });
            
            window.currentHls = hls;
            
            hls.loadSource(streamUrl);
            hls.attachMedia(player);
            
            hls.on(Hls.Events.MANIFEST_PARSED, (event, data) => {
               console.log('✅ Smart Agent: HLS manifest parsed successfully');
               console.log('📊 Stream details:', data);
               const isPremium = streamUrl.startsWith('https://7pal.short.gy/');
               const isBackup = channelName.includes('(Backup)') || channelName.includes('(Secure)');
               
               placeholder.innerHTML = `
                  <div>🎬 ${channelName}</div>
                  <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-accent);">
                     ${isPremium ? '⚡ Premium FHD Agent: Stream Ready' : isBackup ? '🤖 Smart Fallback: Stream Ready' : '🔄 Buffering Stream'}
                  </div>
                  <div style="font-size: 12px; margin-top: 8px; color: var(--cyber-text-dim);">
                     Starting playback...
                  </div>
               `;
            });
            
            hls.on(Hls.Events.FRAG_LOADED, () => {
               if (player.style.display === 'none') {
                  placeholder.style.display = 'none';
                  player.style.display = 'block';
                  
                  // Auto-play with error handling
                  const playPromise = player.play();
                  if (playPromise !== undefined) {
                     playPromise.then(() => {
                        console.log('HLS stream playing successfully');
                        isPlaying = true;
                        document.getElementById('play-pause-btn').textContent = '⏸';
                     }).catch(error => {
                        console.error('HLS autoplay failed:', error);
                        showPlayButton(channelName);
                     });
                  }
               }
            });
            
            hls.on(Hls.Events.ERROR, (event, data) => {
               console.error('🚨 HLS ERROR DETAILS:');
               console.error('  Type:', data.type);
               console.error('  Details:', data.details);
               console.error('  Fatal:', data.fatal);
               console.error('  URL:', data.url);
               console.error('  Response:', data.response);
               console.error('  Full error:', data);
               
               if (data.fatal) {
                  handleStreamError(data.details || data.type, streamUrl, channelName, placeholder);
               }
            });
            
         } else if (player.canPlayType('application/vnd.apple.mpegurl')) {
            console.log('Using native HLS support');
            // Native HLS support (Safari)
            player.src = streamUrl;
            
            // Setup event listeners
            player.onloadstart = () => {
               console.log('Stream loading started');
               placeholder.innerHTML = `
                  <div>🔄 Buffering ${channelName}...</div>
                  <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-text-dim);">
                     Please wait while we connect to the live stream
                  </div>
               `;
            };
            
            player.oncanplay = () => {
               console.log('Stream ready to play');
               placeholder.style.display = 'none';
               player.style.display = 'block';
               
               // Auto-play with error handling
               const playPromise = player.play();
               if (playPromise !== undefined) {
                  playPromise.then(() => {
                     console.log('Stream playing successfully');
                     isPlaying = true;
                     document.getElementById('play-pause-btn').textContent = '⏸';
                  }).catch(error => {
                     console.error('Autoplay failed:', error);
                     placeholder.innerHTML = `
                        <div>▶️ ${channelName} Ready</div>
                        <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-accent);">
                           Click play button to start streaming
                        </div>
                     `;
                     placeholder.style.display = 'flex';
                     player.style.display = 'none';
                  });
               }
            };
            
            player.onerror = (e) => {
               console.error('Stream error:', e);
               let errorMessage = 'Stream temporarily unavailable';
               if (player.error) {
                  switch(player.error.code) {
                     case player.error.MEDIA_ERR_ABORTED:
                        errorMessage = 'Stream aborted by user';
                        break;
                     case player.error.MEDIA_ERR_NETWORK:
                        errorMessage = 'Network error occurred';
                        break;
                     case player.error.MEDIA_ERR_DECODE:
                        errorMessage = 'Stream decode error';
                        break;
                     case player.error.MEDIA_ERR_SRC_NOT_SUPPORTED:
                        errorMessage = 'Stream format not supported';
                        break;
                  }
               }
               
               placeholder.innerHTML = `
                  <div>❌ ${channelName}</div>
                  <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-danger);">
                     ${errorMessage}
                  </div>
                  <div style="font-size: 12px; margin-top: 10px; color: var(--cyber-text-dim);">
                     <button onclick="loadStream('${streamUrl}', '${channelName}')" 
                             style="background: var(--cyber-primary); color: black; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                        🔄 Retry
                     </button>
                  </div>
               `;
               placeholder.style.display = 'flex';
               player.style.display = 'none';
            };
            
            player.onloadeddata = () => {
               console.log('Stream data loaded');
            };
            
         } else {
            // Fallback for unsupported streams
            placeholder.innerHTML = `
               <div>⚠️ ${channelName}</div>
               <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-warning);">
                  HLS streaming not supported in this browser
               </div>
               <div style="font-size: 12px; margin-top: 10px; color: var(--cyber-text-dim);">
                  <a href="${streamUrl}" target="_blank" 
                     style="color: var(--cyber-primary); text-decoration: underline;">
                     Open in external player
                  </a>
               </div>
            `;
         }
         
         videoPlayer = player;
      }
      
      // Helper function to show play button when autoplay fails
      function showPlayButton(channelName) {
         const placeholder = document.getElementById('video-placeholder');
         placeholder.innerHTML = `
            <div>▶️ ${channelName} Ready</div>
            <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-accent);">
               Click play button to start streaming
            </div>
         `;
         placeholder.style.display = 'flex';
         document.getElementById('video-player').style.display = 'none';
      }
      
      // Helper function to get current channel ID
      function getCurrentChannelId() {
         const activeChannel = document.querySelector('.channel-item.active');
         return activeChannel ? activeChannel.dataset.channel : 'demo1';
      }
      
      // Smart error handler with enhanced recovery options
      function handleStreamError(errorType, streamUrl, channelName, placeholder = null) {
         if (!placeholder) placeholder = document.getElementById('video-placeholder');
         let errorMessage = 'Stream temporarily unavailable';
         
         if (errorType.includes('NETWORK')) {
            errorMessage = 'Network connection error';
         } else if (errorType.includes('MANIFEST')) {
            errorMessage = 'Stream format error';
         } else if (errorType.includes('MEDIA')) {
            errorMessage = 'Media playback error';
         }
         
         placeholder.innerHTML = `
            <div>❌ ${channelName}</div>
            <div style="font-size: 14px; margin-top: 10px; color: var(--cyber-danger);">
               ${errorMessage}
            </div>
            <div style="font-size: 12px; margin-top: 10px; color: var(--cyber-text-dim);">
               <button onclick="loadStream('${streamUrl}', '${channelName}')" 
                       style="background: var(--cyber-primary); color: black; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin-right: 10px;">
                  🔄 Retry
               </button>
               <a href="${streamUrl}" target="_blank" 
                  style="color: var(--cyber-primary); text-decoration: underline;">
                  Open Externally
               </a>
            </div>
         `;
         placeholder.style.display = 'flex';
         document.getElementById('video-player').style.display = 'none';
      }

      // Network simulation
      function simulateNetworkDetection() {
         const networks = [
            { status: '📶 WiFi Connected', quality: '🎯 HD Quality' },
            { status: '📱 Hotspot Detected', quality: '🚀 5G Optimized' },
            { status: '📡 Cellular Network', quality: '🔄 Adaptive Quality' },
            { status: '🐌 Low Bandwidth', quality: '💾 Data Saver Mode' }
         ];
         
         let networkIndex = 0;
         setInterval(() => {
            const network = networks[networkIndex];
            document.getElementById('network-status').textContent = network.status;
            document.getElementById('quality-status').textContent = network.quality;
            networkIndex = (networkIndex + 1) % networks.length;
         }, 5000);
      }

      // Channel selection
      document.querySelectorAll('.channel-item').forEach(item => {
         item.addEventListener('click', function() {
            console.log('🎯 Channel clicked:', this.dataset.channel);
            
            document.querySelectorAll('.channel-item').forEach(i => i.classList.remove('active'));
            this.classList.add('active');
            
            const channelId = this.dataset.channel;
            const channelName = this.querySelector('h4').textContent;
            const streamUrl = demoStreams[channelId];
            
            console.log('📺 Loading:', channelName, 'URL:', streamUrl);
            
            currentChannel = channelId;
            currentChannelIndex = channels.indexOf(channelId);
            
            const placeholder = document.getElementById('video-placeholder');
            const player = document.getElementById('video-player');
            
            if (streamUrl) {
               // Try to load the stream with HLS.js
               loadStreamSimple(streamUrl, channelName, placeholder, player);
            } else {
               // Show demo interface if no URL
               placeholder.innerHTML = `
                  <div style="font-size: 24px; margin-bottom: 10px;">📺 ${channelName}</div>
                  <div style="font-size: 16px; margin-bottom: 20px; color: var(--cyber-accent);">
                     ⚡ Premium FHD Stream Interface
                  </div>
                  <div style="font-size: 14px; margin-bottom: 15px; color: var(--cyber-text-dim); text-align: center;">
                     🎬 DEMO MODE: UI Showcase Active<br>
                     📱 Download APK to connect your M3U playlist
                  </div>
               `;
               placeholder.style.display = 'flex';
               player.style.display = 'none';
            }
         });
      });

      // Player controls
      document.getElementById('play-pause-btn').addEventListener('click', function() {
         if (videoPlayer && videoPlayer.src) {
            if (videoPlayer.paused) {
               const playPromise = videoPlayer.play();
               if (playPromise !== undefined) {
                  playPromise.then(() => {
                     isPlaying = true;
                     this.textContent = '⏸';
                     console.log('Playback started');
                  }).catch(error => {
                     console.error('Play failed:', error);
                  });
               }
            } else {
               videoPlayer.pause();
               isPlaying = false;
               this.textContent = '▶';
               console.log('Playback paused');
            }
         } else {
            // Fallback for when no stream is loaded
            isPlaying = !isPlaying;
            this.textContent = isPlaying ? '⏸' : '▶';
            
            const placeholder = document.getElementById('video-placeholder');
            if (placeholder.innerHTML.includes('Ready') && isPlaying) {
               // Try to reload current channel
               const activeChannel = document.querySelector('.channel-item.active');
               if (activeChannel) {
                  const channelId = activeChannel.dataset.channel;
                  const channelName = activeChannel.querySelector('h4').textContent;
                  const streamUrl = demoStreams[channelId];
                  if (streamUrl) {
                     loadStream(streamUrl, channelName);
                  }
               }
            }
         }
      });

      document.getElementById('prev-btn').addEventListener('click', function() {
         currentChannelIndex = currentChannelIndex > 0 ? currentChannelIndex - 1 : channels.length - 1;
         document.querySelectorAll('.channel-item')[currentChannelIndex].click();
      });

      document.getElementById('next-btn').addEventListener('click', function() {
         currentChannelIndex = (currentChannelIndex + 1) % channels.length;
         document.querySelectorAll('.channel-item')[currentChannelIndex].click();
      });

      // Volume control
      const volumeSlider = document.getElementById('volume-slider');
      const volumeDisplay = document.getElementById('volume-display');
      
      volumeSlider.addEventListener('input', function() {
         const volume = this.value / 100;
         volumeDisplay.textContent = this.value + '%';
         
         if (videoPlayer) {
            videoPlayer.volume = volume;
            if (volume === 0) {
               videoPlayer.muted = true;
            } else {
               videoPlayer.muted = false;
            }
         }
      });

      // Fullscreen functionality
      document.getElementById('fullscreen-btn').addEventListener('click', function() {
         if (videoPlayer && videoPlayer.src && !videoPlayer.paused) {
            if (videoPlayer.requestFullscreen) {
               videoPlayer.requestFullscreen();
            } else if (videoPlayer.webkitRequestFullscreen) {
               videoPlayer.webkitRequestFullscreen();
            } else if (videoPlayer.mozRequestFullScreen) {
               videoPlayer.mozRequestFullScreen();
            } else if (videoPlayer.msRequestFullscreen) {
               videoPlayer.msRequestFullscreen();
            } else {
               alert('🚗 Fullscreen Mode\n\nFullscreen is not supported in this browser.');
            }
         } else {
            alert('🚗 Android Auto Fullscreen Mode\n\nStart playing a stream first to enable fullscreen mode.');
         }
      });

      // R2 Storage Base URL
      const R2_BASE_URL = 'https://pub-bdb0b5850f04423d901ad6e7e1195a2a.r2.dev';
      
      // Screenshot mapping
      const screenshots = {
         'carplayer-dashboard': { url: `${R2_BASE_URL}/cartvfirebase/1.png`, title: 'CarPlayer Dashboard' },
         'carplayer-channels': { url: `${R2_BASE_URL}/cartvfirebase/2.png`, title: 'Channel Selection' },
         'carplayer-streaming': { url: `${R2_BASE_URL}/cartvfirebase/3.png`, title: 'Live Streaming' },
         'carplayer-network': { url: `${R2_BASE_URL}/cartvfirebase/4.png`, title: 'Network Detection' }
      };
      
      // Video mapping
      const videos = {
         'carplayer-demo-video': { url: `${R2_BASE_URL}/cartvfirebase/10.mp4`, title: 'Full Demo Video' },
         'carplayer-android-auto': { url: `${R2_BASE_URL}/cartvfirebase/10.mp4`, title: 'Android Auto Integration' },
         'carplayer-network-test': { url: `${R2_BASE_URL}/cartvfirebase/10.mp4`, title: 'Network Optimization Test' }
      };
      
      // Screenshot viewer function
      function openScreenshot(screenshotId) {
         const screenshot = screenshots[screenshotId];
         if (!screenshot) {
            console.error('Screenshot not found:', screenshotId);
            return;
         }
         
         // Create modal overlay
         const modal = document.createElement('div');
         modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
         `;
         
         const img = document.createElement('img');
         img.src = screenshot.url;
         img.alt = screenshot.title;
         img.style.cssText = `
            max-width: 90%;
            max-height: 90%;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(0, 212, 255, 0.5);
         `;
         
         const title = document.createElement('div');
         title.textContent = screenshot.title;
         title.style.cssText = `
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: var(--cyber-primary);
            font-size: 24px;
            font-weight: bold;
            text-shadow: var(--neon-glow);
         `;
         
         modal.appendChild(img);
         modal.appendChild(title);
         document.body.appendChild(modal);
         
         // Close on click
         modal.addEventListener('click', () => {
            document.body.removeChild(modal);
         });
         
         // Close on ESC key
         const escapeHandler = (e) => {
            if (e.key === 'Escape') {
               document.body.removeChild(modal);
               document.removeEventListener('keydown', escapeHandler);
            }
         };
         document.addEventListener('keydown', escapeHandler);
      }
      
      // Video player function
      function openVideo(videoId) {
         const video = videos[videoId];
         if (!video) {
            console.error('Video not found:', videoId);
            return;
         }
         
         console.log('Attempting to play video:', video.url);
         
         // Create modal overlay
         const modal = document.createElement('div');
         modal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
         `;
         
         const videoElement = document.createElement('video');
         videoElement.src = video.url;
         videoElement.controls = true;
         videoElement.autoplay = true;
         videoElement.muted = true; // Add muted to allow autoplay
         videoElement.playsInline = true; // For mobile compatibility
         videoElement.style.cssText = `
            max-width: 90%;
            max-height: 80%;
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(189, 147, 249, 0.5);
         `;
         
         // Add error handling
         videoElement.addEventListener('error', (e) => {
            console.error('Video error:', e);
            const errorMsg = document.createElement('div');
            errorMsg.textContent = 'Error loading video. Please check console for details.';
            errorMsg.style.cssText = `
               color: var(--cyber-danger);
               font-size: 18px;
               margin-top: 20px;
               text-align: center;
            `;
            modal.appendChild(errorMsg);
            
            // Try alternate approach with direct link
            const altLink = document.createElement('a');
            altLink.href = video.url;
            altLink.target = '_blank';
            altLink.textContent = 'Click here to open video directly';
            altLink.style.cssText = `
               color: var(--cyber-primary);
               font-size: 16px;
               margin-top: 10px;
               text-decoration: underline;
            `;
            modal.appendChild(altLink);
         });
         
         // Add loading state
         videoElement.addEventListener('loadstart', () => {
            console.log('Video loading started');
         });
         
         videoElement.addEventListener('canplay', () => {
            console.log('Video can play');
         });
         
         videoElement.addEventListener('loadedmetadata', () => {
            console.log('Video metadata loaded:', {
               duration: videoElement.duration,
               videoWidth: videoElement.videoWidth,
               videoHeight: videoElement.videoHeight
            });
         });
         
         const title = document.createElement('div');
         title.textContent = video.title;
         title.style.cssText = `
            color: var(--cyber-secondary);
            font-size: 24px;
            font-weight: bold;
            text-shadow: var(--neon-glow);
            margin-bottom: 20px;
         `;
         
         const closeBtn = document.createElement('button');
         closeBtn.textContent = '✕ Close';
         closeBtn.style.cssText = `
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: 2px solid var(--cyber-danger);
            color: var(--cyber-danger);
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
         `;
         
         modal.appendChild(title);
         modal.appendChild(videoElement);
         modal.appendChild(closeBtn);
         document.body.appendChild(modal);
         
         // Close handlers
         const closeModal = () => {
            videoElement.pause();
            document.body.removeChild(modal);
         };
         
         closeBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            closeModal();
         });
         
         modal.addEventListener('click', (e) => {
            if (e.target === modal) {
               closeModal();
            }
         });
         
         // Close on ESC key
         const escapeHandler = (e) => {
            if (e.key === 'Escape') {
               closeModal();
               document.removeEventListener('keydown', escapeHandler);
            }
         };
         document.addEventListener('keydown', escapeHandler);
         
         // Prevent modal close when clicking video controls
         videoElement.addEventListener('click', (e) => {
            e.stopPropagation();
         });
      }
      
      // Firebase console viewer
      function viewFirebaseConsole() {
         window.open('https://console.firebase.google.com/project/bluehawana-android-auto/overview', '_blank');
      }
      
      // Testing reports viewer
      function viewTestingReports() {
         window.open('https://console.firebase.google.com/project/bluehawana-android-auto/appdistribution/app/android:1:1055425659261:android:5ee98a20ffff8d755c8c14', '_blank');
      }
      
      // Test video directly
      function testVideoDirectly() {
         const testUrl = `${R2_BASE_URL}/cartvfirebase/10.mp4`;
         console.log('Testing video URL:', testUrl);
         
         // Create a simple test modal
         const testModal = document.createElement('div');
         testModal.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            padding: 20px;
            overflow-y: auto;
         `;
         
         testModal.innerHTML = `
            <div style="max-width: 800px; margin: 0 auto; color: white;">
               <h2 style="color: var(--cyber-primary); margin-bottom: 20px;">Video Test Debug Panel</h2>
               <div style="background: rgba(17, 17, 17, 0.9); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                  <p><strong>Test URL:</strong> ${testUrl}</p>
                  <p><strong>Status:</strong> <span id="test-status">Initializing...</span></p>
                  <div id="test-results" style="margin-top: 20px;"></div>
               </div>
               
               <div style="margin: 20px 0;">
                  <h3 style="color: var(--cyber-secondary);">Method 1: HTML5 Video Element</h3>
                  <video id="test-video" width="100%" controls style="max-width: 600px; border-radius: 10px;">
                     <source src="${testUrl}" type="video/mp4">
                     Your browser does not support the video tag.
                  </video>
               </div>
               
               <div style="margin: 20px 0;">
                  <h3 style="color: var(--cyber-secondary);">Method 2: Direct Link</h3>
                  <a href="${testUrl}" target="_blank" style="color: var(--cyber-primary); text-decoration: underline;">
                     Open video in new tab
                  </a>
               </div>
               
               <div style="margin: 20px 0;">
                  <h3 style="color: var(--cyber-secondary);">Method 3: Iframe Embed</h3>
                  <iframe src="${testUrl}" width="100%" height="400" style="max-width: 600px; border-radius: 10px; border: 2px solid var(--cyber-border);"></iframe>
               </div>
               
               <button onclick="this.parentElement.parentElement.remove()" style="
                  background: transparent;
                  border: 2px solid var(--cyber-danger);
                  color: var(--cyber-danger);
                  padding: 10px 20px;
                  border-radius: 5px;
                  cursor: pointer;
                  font-size: 16px;
                  margin-top: 20px;
               ">Close Test Panel</button>
            </div>
         `;
         
         document.body.appendChild(testModal);
         
         // Test the video
         const testVideo = document.getElementById('test-video');
         const testStatus = document.getElementById('test-status');
         const testResults = document.getElementById('test-results');
         
         // Check video support
         const videoSupport = testVideo.canPlayType('video/mp4');
         testResults.innerHTML += `<p>Browser MP4 support: ${videoSupport || 'No support'}</p>`;
         
         testVideo.addEventListener('loadstart', () => {
            testStatus.textContent = 'Loading video...';
            testResults.innerHTML += '<p>Event: loadstart</p>';
         });
         
         testVideo.addEventListener('error', (e) => {
            testStatus.textContent = 'Error loading video!';
            testResults.innerHTML += `<p style="color: var(--cyber-danger);">Error: ${e.target.error ? e.target.error.message : 'Unknown error'}</p>`;
            console.error('Video error details:', e);
         });
         
         testVideo.addEventListener('loadeddata', () => {
            testStatus.textContent = 'Video loaded successfully!';
            testResults.innerHTML += '<p style="color: var(--cyber-accent);">Event: loadeddata - Video is ready!</p>';
         });
         
         testVideo.addEventListener('canplay', () => {
            testResults.innerHTML += '<p>Event: canplay</p>';
         });
         
         // Also test with fetch to check CORS
         fetch(testUrl, { method: 'HEAD' })
            .then(response => {
               testResults.innerHTML += `<p>Fetch test: ${response.ok ? 'Success' : 'Failed'} (Status: ${response.status})</p>`;
               testResults.innerHTML += `<p>Content-Type: ${response.headers.get('Content-Type') || 'Not specified'}</p>`;
               testResults.innerHTML += `<p>CORS headers: ${response.headers.get('Access-Control-Allow-Origin') || 'Not present'}</p>`;
            })
            .catch(error => {
               testResults.innerHTML += `<p style="color: var(--cyber-danger);">Fetch error: ${error.message}</p>`;
            });
      }

      // Show technical stream information
      function showStreamInfo(channelName) {
         alert(`🔧 CarPlayer IPTV Technical Details\n\nChannel: ${channelName}\nResolution: 1920x1080 FHD\nCodec: H.264/AAC\nProtocol: HLS (HTTP Live Streaming)\nOptimization: Android Auto Compatible\n\n📱 This demo showcases the CarPlayer interface.\nConnect your M3U playlist for live streaming.`);
      }

      // APK download via Firebase App Distribution
      function downloadAPK(appName) {
         if (appName === 'carplayer') {
            window.open('https://appdistribution.firebase.google.com/testerapps/1:1055425659261:android:5ee98a20ffff8d755c8c14/releases/4akk35cdhi1lo', '_blank');
         }
      }

      // Test all 7pal.short.gy URLs on load
      async function testAllUrls() {
         console.log('🧪 TESTING ALL 7PAL.SHORT.GY URLS...');
         
         for (const [channelId, url] of Object.entries(demoStreams)) {
            try {
               console.log(`\n📡 Testing ${channelId}: ${url}`);
               
               // Test with fetch first
               const response = await fetch(url, { 
                  method: 'GET',
                  mode: 'no-cors' // Try no-cors mode to bypass CORS
               });
               
               console.log(`✅ ${channelId}: Fetch completed (no-cors mode)`);
               
               // Also try with cors mode to see actual response
               try {
                  const corsResponse = await fetch(url, { method: 'GET' });
                  console.log(`📊 ${channelId}: Status ${corsResponse.status}, Type: ${corsResponse.type}`);
                  console.log(`🔗 Final URL: ${corsResponse.url}`);
               } catch (corsError) {
                  console.log(`⚠️ ${channelId}: CORS blocked - ${corsError.message}`);
               }
               
            } catch (error) {
               console.error(`❌ ${channelId}: ${error.message}`);
            }
         }
         
         console.log('\n🏁 URL TESTING COMPLETE');
      }
      
      // Initialize demo
      simulateNetworkDetection();
      testAllUrls(); // Test URLs on load
      
      // Auto-select first channel after a delay  
      setTimeout(() => {
         console.log('🎯 Auto-selecting first channel for demo');
         document.querySelector('.channel-item').click();
      }, 2000);
      
      // Set initial volume
      const player = document.getElementById('video-player');
      if (player) {
         player.volume = 0.5; // 50%
         player.muted = false;
      }
   </script>
</body>
</html>